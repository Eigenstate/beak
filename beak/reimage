#!/usr/bin/env python
"""
Does reimaging as a standalone python script
"""
import argparse
from beak.reimagers import *

if __name__ == "__main__":
    # Process args
    parser = argparse.ArgumentParser(prog="reimage")
    parser.add_argument("-p", "--psf", dest="psf", metavar="<psf>", type=str,
                        required=True, help="PSF file for simulated system")
    parser.add_argument("-r", "--revision", dest="revision",
                        metavar="<revision>", type=str, required=True,
                        help="Simulation revision number")
    parser.add_argument("--every", dest="skip", metavar="<N>",
                        type=int, default=1, help="Save every Nth frame. Defaults"
                        " to all frames")
    parser.add_argument("--equilibration", dest="alleq", default=True,
                        action="store_true", help="Include equilibration trajectories "
                        "in final reimaged file. Defaults to True.")
    parser.add_argument("--align", dest="align", default=False,
                        action="store_true", help="Align frames to input coordinates. "
                        "Defaults to false.")
    parser.add_argument("--strip", dest="strip", type=str, default=None,
                        metavar="<selection>",
                        help="Atom selection mask for stripped residues. New prmtop "
                             "will be saved as <psf>_stripped.prmtop")

    opts = parser.parse_args(sys.argv[1:])

    reimage(psf=opts.get("psf"),
            revision=opts.get("revision"),
            skip=opts.get("skip"),
            alleq=opts.get("alleq"),
            align=opts.get("align"),
            stripmask=opts.get("strip"))

